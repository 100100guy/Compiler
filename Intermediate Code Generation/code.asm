.MODEL SMALL

.STACK 400H

.DATA


.CODE
	FLAG DB 0
	NL DB 13,10,"$"
	NUMBER_STRING DB "00000$" 

main PROC
	MOV AX, @DATA
	MOV DS, AX
PUSH BP
MOV BP, SP
PUSH AX ; a[4] decl
PUSH AX ; a[3] decl
PUSH AX ; a[2] decl
PUSH AX ; a[1] decl
PUSH AX ; a[0] decl
PUSH AX ; k decl
PUSH 3
POP BX ; popped index expr 3
SHL BX, 1
ADD BX, -10
;ADD BX, BP
PUSH BP
ADD BP, BX
MOV AX, [BP]
POP BP
;MOV AX, [BX]
PUSH AX ; value of a[3]
PUSH BX ; index 3
PUSH 16
POP AX ; r-val of assignop 16
POP BX
;MOV [BX], AX
PUSH BP
ADD BP, BX
MOV [BP], AX
POP BP ; assigning to a
POP AX
MOV AX, -12[BP]
PUSH AX ; k called
PUSH 3
POP BX ; popped index expr 3
SHL BX, 1
ADD BX, -10
;ADD BX, BP
PUSH BP
ADD BP, BX
MOV AX, [BP]
POP BP
;MOV AX, [BX]
PUSH AX ; value of a[3]
PUSH BX ; index 3
POP BX ; r-value, no need for index
POP AX ; r-val of assignop (a)
MOV -12[BP], AX ; assigning (a) to k
POP AX
MOV AX, -12[BP]
CALL PRINT ; argument k in AX
main_EXIT:
	MOV SP, BP ; Restoring SP
	POP BP
	MOV AH, 4CH
	INT 21H
main ENDP

PRINT PROC ; PRINTS A WORD INTEGER IN AX
LEA SI, NUMBER_STRING ; IS 00000
ADD SI, 5 ; START FROM ONE'S DIGIT
CMP AX, 0
JNL PRINT_LOOP
MOV FLAG, 1
NEG AX
PRINT_LOOP:
DEC SI
MOV DX, 0 ; DX:AX = 0000:AX
MOV CX, 10
DIV CX
ADD DL, '0'
MOV [SI], DL
CMP AX, 0
JNE PRINT_LOOP
CMP FLAG, 0
JNG NOT_NEGATIVE
MOV AH, 2
MOV DL, 45
INT 21H
MOV FLAG, 0
NOT_NEGATIVE:
MOV DX, SI
MOV AH, 9
INT 21H
MOV DX, OFFSET NL ; NEWLINE
MOV AH, 9
INT 21H
RET
PRINT ENDP
END MAIN
